## Техническое задание (ТЗ)  
**Проект: Автоматизация сбора данных из Telegram-каналов**

### 1. Цель проекта  
Разработать скрипт или программу для автоматизированного сбора данных из предоставленного списка Telegram-каналов и сохранения их в CSV-файл для дальнейшего анализа.

### 2. Описание задачи  
Необходимо собрать следующую информацию из каждого Telegram-канала из предоставленного списка юзернеймов:  
- **Дата последнего поста**: Дата публикации самого последнего сообщения в канале.  
- **Количество постов за неделю**: Число сообщений, опубликованных в канале за последние 7 дней.  
- **Юзернейм в описании канала**: Юзернейм в формате `@username`, указанный в описании (биографии) канала, если он присутствует.  

Собранные данные должны быть сохранены в таблицу в формате CSV.

### 3. Входные данные  
- Список юзернеймов Telegram-каналов (например, `@channel1`, `@channel2`), предоставленный в текстовом файле (один юзернейм на строку) или в виде списка в коде.  
- Пример:  
  ```
  @channel1
  @channel2
  @channel3
  ```

### 4. Выходные данные  
- Файл в формате CSV с таблицей, содержащей следующие колонки:  
  | Юзернейм канала | Дата последнего поста | Количество постов за неделю | Юзернейм из описания |  
  |-----------------|-----------------------|-----------------------------|----------------------|  
  | @channel1       | 2023-10-15            | 5                           | @contact1            |  
  | @channel2       | 2023-10-14            | 0                           | -                    |  
  | @channel3       | 2023-10-16            | 3                           | @contact3            |  
- Поле «Юзернейм из описания» заполняется значением `@username`, если оно найдено, или остается пустым/содержит символ «-», если юзернейм в описании отсутствует.

### 5. Технические требования  
#### 5.1. Используемые инструменты  
- **API Telegram**: Использовать официальный Telegram Bot API или библиотеку, такую как `python-telegram-bot` или `Telethon`, для доступа к данным каналов.  
- **Язык программирования**: Рекомендуется Python (или другой по согласованию).  
- **Библиотеки**:  
  - Для работы с Telegram API (например, `Telethon`).  
  - Для обработки CSV (например, `pandas` или стандартный модуль `csv`).  

#### 5.2. Функциональность  
- Скрипт должен:  
  1. Прочитать список юзернеймов каналов из входного файла или встроенного списка.  
  2. Подключиться к Telegram API.  
  3. Для каждого канала собрать:  
     - Дату последнего поста (из последнего сообщения).  
     - Количество постов за последние 7 дней (просмотр истории сообщений).  
     - Юзернейм из описания канала (извлечение `@username` с помощью регулярных выражений или парсинга).  
  4. Сохранить данные в CSV-файл.  

#### 5.3. Обработка ошибок  
- Учитывать возможные ошибки:  
  - Канал не существует (например, удален или введен некорректный юзернейм).  
  - Канал приватный или доступ ограничен.  
  - Превышение лимитов API (добавить задержки между запросами).  
- В случае ошибки записывать в CSV строку с указанием проблемы (например, «Канал недоступен» в соответствующей колонке).

#### 5.4. Ограничения API  
- Соблюдать лимиты Telegram API по количеству запросов (например, не более 30 запросов в секунду для ботов или 1 запроса в секунду для отдельных каналов).  
- Использовать задержки (sleep) для предотвращения блокировки.

### 6. Безопасность  
- **Учетные данные API**:  
  - Хранить API-токен (Bot Token или api_id/api_hash для Telethon) в отдельном конфигурационном файле или переменных окружения.  
  - Не включать учетные данные в код или выходные файлы.  
- **Конфиденциальность**: Не собирать и не сохранять личные данные пользователей, не относящиеся к задаче.

### 7. Тестирование  
- Провести тестирование на небольшом наборе каналов (3-5 юзернеймов).  
- Проверить:  
  - Корректность сбора данных (даты, количества постов, юзернейма).  
  - Обработку ошибок (несуществующий канал, приватный канал).  
  - Формат и читаемость выходного CSV-файла.

### 8. Документация  
- **Инструкция по установке**:  
  - Указать, как установить необходимые библиотеки (например, `pip install telethon pandas`).  
  - Описать настройку API (получение токена у @BotFather или регистрация приложения в Telegram).  
- **Инструкция по запуску**:  
  - Указать команду для запуска скрипта (например, `python script.py input.txt output.csv`).  
  - Описать формат входного файла (список юзернеймов, по одному на строку).  

Пример команды:  
```bash
python telegram_scraper.py channels.txt result.csv
```

### 9. Этапы реализации  
1. **Настройка окружения**:  
   - Установка библиотек.  
   - Получение и настройка API-доступа.  
2. **Разработка скрипта**:  
   - Функция чтения списка каналов.  
   - Функции сбора данных (дата, количество постов, юзернейм).  
   - Функция сохранения в CSV.  
3. **Тестирование и отладка**:  
   - Проверка на тестовых данных.  
   - Исправление ошибок.  
4. **Финализация**:  
   - Подготовка документации.  
   - Передача готового решения.
